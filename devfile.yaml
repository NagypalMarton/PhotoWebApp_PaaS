schemaVersion: 2.2.0
metadata:
  name: photowebapp-paas
components:
  - name: import-build-image
    image:
      imageName: image-registry.openshift-image-registry.svc:5000/myproject/photowebapp-devfile-import:latest
      autoBuild: false
      dockerfile:
        uri: .devfile/Dockerfile
        buildContext: .
  - name: workspace
    container:
      image: quay.io/devfile/universal-developer-image:latest
      mountSources: false
      endpoints:
        - name: http-8080
          targetPort: 8080
          exposure: public
          protocol: http
  - name: k8s-deploy
    kubernetes:
      uri: openshift/devfile-k8s-deploy.yaml
  - name: openshift-stack
    openshift:
      uri: openshift/openshift-all.yaml
commands:
  - id: build
    apply:
      component: import-build-image
      group:
        kind: build
        isDefault: true
  - id: deploy-k8s-sample
    apply:
      component: k8s-deploy
      group:
        kind: deploy
        isDefault: false
  - id: deploy-openshift-stack
    apply:
      component: openshift-stack
      group:
        kind: deploy
        isDefault: false
  - id: deploy
    composite:
      commands:
        - build
        - deploy-openshift-stack
      parallel: false
      group:
        kind: deploy
        isDefault: true
  - id: up
    composite:
      commands:
        - deploy
      parallel: false
